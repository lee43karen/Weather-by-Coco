import React from "react";
import { render, screen } from "@testing-library/react";
import DailyForecast from "./DailyForecast";

describe("DailyForecast", () => {
  const mockData = [
    {
      dt: 1714492800,
      sunrise: 1714470992,
      sunset: 1714521174,
      moonrise: 1714456500,
      moonset: 1714489020,
      moon_phase: 0.72,
      summary: "Expect a day of partly cloudy with rain",
      temp: {
        day: 21.27,
        min: 13.3,
        max: 24.23,
        night: 14.33,
        eve: 20.86,
        morn: 13.3,
      },
      feels_like: {
        day: 20.97,
        night: 14.12,
        eve: 20.57,
        morn: 13.24,
      },
      pressure: 1012,
      humidity: 58,
      dew_point: 12.42,
      wind_speed: 3.05,
      wind_deg: 129,
      wind_gust: 6.17,
      weather: [
        {
          id: 501,
          main: "Rain",
          description: "moderate rain",
          icon: "10d",
        },
      ],
      clouds: 98,
      pop: 1,
      rain: 4.15,
      uvi: 6.14,
    },
    {
      dt: 1714579200,
      sunrise: 1714557316,
      sunset: 1714607638,
      moonrise: 1714545300,
      moonset: 1714579920,
      moon_phase: 0.75,
      summary: "Expect a day of partly cloudy with clear spells",
      temp: {
        day: 23.27,
        min: 13.77,
        max: 25.81,
        night: 13.77,
        eve: 22.9,
        morn: 14.25,
      },
      feels_like: {
        day: 22.72,
        night: 13.5,
        eve: 22.47,
        morn: 14.08,
      },
      pressure: 1013,
      humidity: 41,
      dew_point: 9.17,
      wind_speed: 4.13,
      wind_deg: 325,
      wind_gust: 12.48,
      weather: [
        {
          id: 800,
          main: "Clear",
          description: "clear sky",
          icon: "01d",
        },
      ],
      clouds: 0,
      pop: 0.8,
      uvi: 7.29,
    },
    {
      dt: 1714665600,
      sunrise: 1714643641,
      sunset: 1714694101,
      moonrise: 1714633620,
      moonset: 1714670880,
      moon_phase: 0.79,
      summary: "Expect a day of partly cloudy with clear spells",
      temp: {
        day: 24.48,
        min: 12.22,
        max: 25.23,
        night: 14.45,
        eve: 22.11,
        morn: 13.33,
      },
      feels_like: {
        day: 23.82,
        night: 13.8,
        eve: 21.58,
        morn: 13.07,
      },
      pressure: 1013,
      humidity: 32,
      dew_point: 6.31,
      wind_speed: 5.44,
      wind_deg: 308,
      wind_gust: 9.79,
      weather: [
        {
          id: 802,
          main: "Clouds",
          description: "scattered clouds",
          icon: "03d",
        },
      ],
      clouds: 27,
      pop: 0,
      uvi: 6.64,
    },
    {
      dt: 1714752000,
      sunrise: 1714729967,
      sunset: 1714780564,
      moonrise: 1714721700,
      moonset: 1714761840,
      moon_phase: 0.83,
      summary: "There will be partly cloudy today",
      temp: {
        day: 17.53,
        min: 9.78,
        max: 18.05,
        night: 9.78,
        eve: 14.04,
        morn: 11.41,
      },
      feels_like: {
        day: 16.72,
        night: 8.59,
        eve: 13.14,
        morn: 10.75,
      },
      pressure: 1021,
      humidity: 53,
      dew_point: 7.64,
      wind_speed: 4.5,
      wind_deg: 142,
      wind_gust: 6.65,
      weather: [
        {
          id: 804,
          main: "Clouds",
          description: "overcast clouds",
          icon: "04d",
        },
      ],
      clouds: 100,
      pop: 0,
      uvi: 7.34,
    },
    {
      dt: 1714838400,
      sunrise: 1714816294,
      sunset: 1714867028,
      moonrise: 1714809600,
      moonset: 1714852800,
      moon_phase: 0.87,
      summary: "There will be partly cloudy until morning, then rain",
      temp: {
        day: 10.12,
        min: 8.01,
        max: 10.12,
        night: 8.1,
        eve: 8.2,
        morn: 9.03,
      },
      feels_like: {
        day: 9.15,
        night: 5.85,
        eve: 6.31,
        morn: 7.87,
      },
      pressure: 1026,
      humidity: 75,
      dew_point: 5.53,
      wind_speed: 3.67,
      wind_deg: 113,
      wind_gust: 9.05,
      weather: [
        {
          id: 501,
          main: "Rain",
          description: "moderate rain",
          icon: "10d",
        },
      ],
      clouds: 100,
      pop: 1,
      rain: 21.59,
      uvi: 2.9,
    },
    {
      dt: 1714924800,
      sunrise: 1714902623,
      sunset: 1714953491,
      moonrise: 1714897380,
      moonset: 1714943760,
      moon_phase: 0.91,
      summary:
        "You can expect rain in the morning, with partly cloudy in the afternoon",
      temp: {
        day: 8.17,
        min: 7.99,
        max: 9.06,
        night: 8.67,
        eve: 9.06,
        morn: 8.27,
      },
      feels_like: {
        day: 6,
        night: 8.14,
        eve: 7.5,
        morn: 5.78,
      },
      pressure: 1022,
      humidity: 98,
      dew_point: 7.46,
      wind_speed: 4.2,
      wind_deg: 99,
      wind_gust: 10.07,
      weather: [
        {
          id: 502,
          main: "Rain",
          description: "heavy intensity rain",
          icon: "10d",
        },
      ],
      clouds: 100,
      pop: 1,
      rain: 32.18,
      uvi: 0.15,
    },
    {
      dt: 1715011200,
      sunrise: 1714988953,
      sunset: 1715039953,
      moonrise: 1714985280,
      moonset: 1715034780,
      moon_phase: 0.94,
      summary: "Expect a day of partly cloudy with clear spells",
      temp: {
        day: 17.16,
        min: 7.74,
        max: 20.95,
        night: 12.84,
        eve: 20.95,
        morn: 7.74,
      },
      feels_like: {
        day: 16.11,
        night: 12.03,
        eve: 20.04,
        morn: 6.66,
      },
      pressure: 1019,
      humidity: 45,
      dew_point: 4.86,
      wind_speed: 3.69,
      wind_deg: 334,
      wind_gust: 9.97,
      weather: [
        {
          id: 800,
          main: "Clear",
          description: "clear sky",
          icon: "01d",
        },
      ],
      clouds: 1,
      pop: 0,
      uvi: 1,
    },
    {
      dt: 1715097600,
      sunrise: 1715075285,
      sunset: 1715126416,
      moonrise: 1715073360,
      moonset: 1715125920,
      moon_phase: 0,
      summary:
        "You can expect partly cloudy in the morning, with clearing in the afternoon",
      temp: {
        day: 20.31,
        min: 10.51,
        max: 23.09,
        night: 14.35,
        eve: 22.87,
        morn: 10.51,
      },
      feels_like: {
        day: 19.55,
        night: 14.11,
        eve: 22.26,
        morn: 9.6,
      },
      pressure: 1014,
      humidity: 44,
      dew_point: 7.47,
      wind_speed: 3.03,
      wind_deg: 203,
      wind_gust: 4.55,
      weather: [
        {
          id: 804,
          main: "Clouds",
          description: "overcast clouds",
          icon: "04d",
        },
      ],
      clouds: 100,
      pop: 0,
      uvi: 1,
    },
  ];

  it("renders daily forecast with descriptions", () => {
    render(<DailyForecast data={mockData} />);

    expect(screen.getByText("Daily Forecast")).toBeInTheDocument();
    expect(screen.getByText("Expect a day of partly cloudy with rain")).toBeInTheDocument();
    expect(screen.getAllByText("Expect a day of partly cloudy with clear spells")).toHaveLength(2);
    expect(screen.getByText("There will be partly cloudy today")).toBeInTheDocument();
    expect(screen.getByText("There will be partly cloudy until morning, then rain")).toBeInTheDocument();
  });

  it("returns nothing if no data present", () => {
    render(<DailyForecast />);
    expect(screen.queryByRole("heading")).not.toBeInTheDocument();
  });
});
